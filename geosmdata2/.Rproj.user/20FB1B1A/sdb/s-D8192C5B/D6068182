{
    "contents" : "\n# https://github.com/malexan/nominatim/blob/master/geocode.r\nlibrary(rjson)\nrequire(RCurl)\nrequire(XML)\nrequire(stringr)\nrequire(plyr)\n\n#' Nominatim\n#'\n#' geocodes a location using OpenStreetMap.\n#'\n#' @param output verbose level\n#' @param messaging turn messaging on/off\n#' @return depends (at least a data.frame with variables lon and lat)\n#' @author Alexander Matrunich \\email{alexander@@matrunich.com}\n#' @details Based on David Kahle's geocode.R from ggmap\n#' @seealso \\url{http://wiki.openstreetmap.org/wiki/Nominatim}\n\nnominatim <- function(location, output = c('latlon','latlona','more','all'),\n                      messaging = FALSE) {\n  house <- FALSE\n  if (is.list(location)) {\n    house <- TRUE\n    house_number <- location[[1]]\n    # Extract first digits from house number\n    house_number_fdig <- str_extract(house_number, '^[0-9]*')\n    location <- str_c(house_number_fdig, location[[2]], sep = ',')\n  }\n\n  location <- str_replace_all(location, ' ', '+')\n  location <- URLencode(location)\n  url_string <- str_c('http://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=', location)\n\n  # Geocode\n  gc <- fromJSON(paste(readLines(url(url_string),warn=F), collapse = ''))\n  if(messaging) message(' done.')\n  return(gc)\n  # Extract place with required house number\n  gc <- xmlRoot(xmlTreeParse(gc, getDTD=F, useInternalNodes = T))\n  # return(xmlToList(gc))\n  if(house) {\n    gc <- getNodeSet(gc, str_c('//place[house_number/text() = \"', house_number, '\"]'))\n    if(output == 'all') return(xmlToList(gc[[1]]))\n  }\n  if(!house) {\n    return(xmlToList(gc))\n  }\n  #format geocoded data\n  return(gc)\n}\n\n\n\nnominatim(location=\"Mannheim Heumarkt 2\")\n",
    "created" : 1435751370340.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2657142915",
    "id" : "D6068182",
    "lastKnownWriteTime" : 1435753052,
    "path" : "J:/Work/Statistik/Kolb/Paper/UseOSMdata/rcode/rOSM_M_OSMnominatim.R",
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "type" : "r_source"
}