---
title: "R-package sp"
author: "Jan-Philipp Kolb"
date: "04/22/2015"
output: html_document
---



```{r,echo=F}
library(knitr)
ca <- T
```

## The package [sp](https://cran.r-project.org/web/packages/sp/index.html)

- Classes and methods for spatial data
- Authors: Edzer Pebesma, Roger Bivand, Barry Rowlingson, Virgilio Gomez-Rubio et. al.
- Many [Introductions](http://ifgi.uni-muenster.de/~epebe_01/Aufbaukurs/R/slides_R.pdf) available

```{r,message=F,cache=ca,warning=F}
library(sp)
```

## Hello world

- A first example using data from maptools ([ISO2-codes](http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2))


```{r,message=F,cache=ca,warning=F}
library(maptools)
data("wrld_simpl")
ISO2codes <- wrld_simpl@data$ISO2
countries <- c("FR","DE","AT","CH")
ind <- match(countries,ISO2codes)
my_map <- wrld_simpl[ind,]
```

## Plot my map

```{r}
plot(my_map)
```


## The data set

```{r,eval=F,cache=ca,warning=F}
head(my_map@data)
```


```{r,echo=F,cache=ca,warning=F}
library(knitr)
kable(my_map@data[1:4,c("ISO2","NAME","AREA","POP2005","REGION")])
```



## First example

```{r,cache=ca,warning=F}
spplot(my_map,"POP2005")
```

## Using `colorRamps`

```{r,message=F,cache=ca,warning=F}
library(colorRamps)
spplot(my_map,"POP2005",col.regions=blue2red(100))
```

## Using `colorRamps`

```{r,cache=ca,warning=F}
spplot(my_map,"POP2005",col.regions=blue2green(100))
```

## Using `colorRamps`

```{r,cache=ca,warning=F}
spplot(my_map,"POP2005",col.regions=green2red(100))
```

## Using `colorRamps`
```{r,cache=ca,warning=F}
spplot(my_map,"POP2005",col.regions=blue2yellow(100))
```

## Using `colorRamps`
```{r,cache=ca,warning=F}
spplot(my_map,"POP2005",col.regions=matlab.like(100))
```

## Using synthetic data

Generating synthetic data (Population 2010)

```{r,cache=ca,warning=F}
my_map$Pop2010 <- my_map$POP2005 + 
                    runif(length(my_map),-10000,10000)
```


## Colors [matlab](http://de.mathworks.com/products/matlab/) like

```{r,cache=ca,warning=F}
spplot(my_map,c("POP2005","Pop2010"),
       col.regions=matlab.like(100))
```

## More examples 

- [Stamen maps with spplot](https://procomun.wordpress.com/2013/04/24/stamen-maps-with-spplot/)

- [Know India through visualisation](http://justanotherdatablog.blogspot.de/2014/02/know-india-through-visualisations-1.html)

- [Great circles](https://procomun.wordpress.com/2011/05/20/great-circles/)

- [Canadian vote compass](http://blog.revolutionanalytics.com/2011/12/vote-compass-visualizing-canadian-poll-results-with-r.html)

- [More colors in R](http://www.r-bloggers.com/using-the-new-viridis-colormap-in-r-thanks-to-simon-garnier/)


## Vignettes for package `sp`

- Edzer Pebesma - [Customising spatial data classes and methods](https://cran.r-project.org/web/packages/sp/vignettes/csdacm.pdf)

- Edzer Pebesma and Roger S. Bivand - [S Classes and Methods for Spatial Data: the `sp` Package](https://cran.r-project.org/web/packages/sp/vignettes/intro_sp.pdf)

- Edzer Pebesma - [Map overlay and spatial aggregation in sp](https://cran.r-project.org/web/packages/sp/vignettes/over.pdf)



## Projections

- [Spatial Reference Identifier](https://en.wikipedia.org/wiki/SRID)

- [Working with shapefiles](http://lincolnmullen.com/projects/dh-r/geospatial-data.html)

- [srid for OpenStreetMap](http://gis.stackexchange.com/questions/48949/epsg-3857-or-4326-for-googlemaps-openstreetmap-and-leaflet)