---
title: "Library maptools"
author: "Jan-Philipp Kolb"
date: "04/21/2015"
output: ioslides_presentation
---

```{r,echo=F}
library(knitr)
```



## The library maptools

- The data set `wrld_simpl` from package [maptools](https://cran.r-project.org/web/packages/maptools/index.html) has polygons for the most countries in the world

```{r,message=F}
library(maptools)
data(wrld_simpl)
```

```{r,echo=F}
kable(wrld_simpl@data[1:4,1:5])
```

## Hello world

```{r}
plot(wrld_simpl)
```


## The data set behind

```{r,eval=F}
head(wrld_simpl@data)
```


```{r,results='asis',echo=F}
library(knitr)
kable(wrld_simpl@data[1:4,1:5])
```


## The structure of the data set

- with head you get only the first entries

```{r}
head(wrld_simpl@data$NAME)
```


## A logical request

```{r}
ind_SA <- wrld_simpl@data$NAME =="South Africa"
head(ind_SA)
```

```{r}
table(ind_SA)
```

## A map for South Africa

- plot only one country

```{r}
SouthAfrica <- wrld_simpl[ind_SA,]
plot(SouthAfrica)
```

## Select more than one country

```{r}
EuropeList <- c('Germany', 'France')
my_map <- wrld_simpl[wrld_simpl$NAME %in% EuropeList, ]
plot(my_map)
```

## More color

```{r}
my_map@data$color <- c("blue","green")
plot(my_map,col=my_map@data$color)
```

## More color for the world

```{r}
plot(wrld_simpl, bg='azure2', col='khaki', border='#AAAAAA')
```

## A map for Europe

```{r}
Europe <- wrld_simpl[wrld_simpl$REGION=="150",]
plot(Europe,col="royalblue")
```


## Europe without Russia

```{r}
ind <- which(Europe@data$NAME=="Russia")
EU <- Europe[-ind,]
plot(EU,col="blue",border="red")
```

## Play with colors

```{r}
EU$colors <- "green"
plot(EU,col=EU$colors,border="red")
pop05 <- Europe$POP2005
Europe$colors[pop05>mean(pop05)] <- "royalblue"
plot(Europe,col=Europe$colors)
```

## Play with colors

[Colors in R](http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf)

```{r}
Europe$colors[pop05>median(pop05)] <- "chocolate4"
plot(Europe,col=Europe$colors)
```

## Plotting Europe - shading blue

```{r}
val <- Europe$POP2005/max(Europe$POP2005)
plot(Europe,col=rgb(0,0,val))
```

## Plotting Europe - shading red

```{r}
val <- Europe$POP2005/max(Europe$POP2005)
plot(Europe,col=rgb(val,0,0))
```

## Plotting Europe - shading green

```{r}
val <- Europe$POP2005/max(Europe$POP2005)
plot(Europe,col=rgb(0,val,0))
```

## Plotting Europe - shading gray

```{r}
val <- Europe$POP2005/max(Europe$POP2005)
plot(Europe,col=rgb(val,val,val))
```

## Plotting Europe - two plots beside

```{r}
par(mfrow=c(1,2))
plot(Europe,col=rgb(val,0,val))
plot(Europe,col=rgb(val,val,0))
```

## Plotting Europe - add points

```{r}
which(Europe$ISO2=="FR") # 14
plot(Europe)
points(Europe$LON[14],Europe$LAT[14],col="red",pch=20)
```

## Plotting Europe - add bubbles

```{r}
pop <- Europe$POP2005
pop <- pop/max(pop)*10
plot(Europe)
points(Europe$LON,Europe$LAT,cex=pop,col=rgb(0,0,1,.2),
pch=20)
```

## Plotting Europe - add text

```{r}
plot(Europe)
text(Europe$LON,Europe$LAT,Europe$ISO2,col="red")
```

## Plotting Europe - add lines

```{r,eval=F}
which(Europe$ISO2=="FR") # 15
which(Europe$ISO2=="DE") # 16
```


```{r}
Dat <- cbind(Europe$LON[15:16],Europe$LAT[15:16])
plot(Europe)
lines(Dat,col="red",lwd=2)
```

## Plotting Europe - add symbols

```{r,eval=F}
library(png)
fDEU <- readPNG("DEUflag.png")
fDEU<- as.raster(fDEU[,,1:3])
plot(Europe)
rasterImage(fDEU,Europe$LON[16],Europe$LAT[16],13,54)
```

